name: python-demo

on: [push]

jobs:
  build:

    runs-on: ubuntu-latest
    env:
      JF_ARTIFACTORY_1: ${{ secrets.JF_ARTIFACTORY_SECRET_1 }}
      MODULE_NAME: "jfrog-python-example"
      SERVER_ID: "rtsaas"
      REPO: "auth-python-virtual"
    steps:
      - name: Setup JFrog CLI
        uses: jfrog/setup-jfrog-cli@v3.4.0
      - name: Ping JFrog CLI
        run: jf rt ping --server-id=$SERVER_ID
      - name: Run Python build and publish
        run: |
          jf pipc --server-id-resolve=$SERVER_ID --repo-resolve=$REPO
          # Build the python project
          jf rt pipi -r requirements.txt --module=$MODULE_NAME
